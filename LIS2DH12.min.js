function e(a,c,f){this.spi=a;this.cs=c;this.callback=f;if(this.read(b.WHO_AM_I,1)[0]!=b.I_AM_MASK)throw"LIS2DH12 WHO_AM_I check failed";this.g_scale=b.SCALE2G;this.interval=void 0}var b={WHO_AM_I:15,CTRL_REG1:32,CTRL_REG2:33,CTRL_REG3:34,CTRL_REG4:35,OUT_X_L:40,I_AM_MASK:51,ODR_MASK_1HZ:16,ODR_MASK_10HZ:32,ODR_MASK_25HZ:48,ODR_MASK_50HZ:64,ODR_MASK_100HZ:80,ODR_MASK_200HZ:96,ODR_MASK_400HZ:112,ODR_MASK_1620HZ:128,ODR_MASK_HIGH_RES:144,LPEN_MASK:8,XYZ_EN_MASK:7,HR_MASK:8,SCALE2G:0,SCALE4G:1,
SCALE8G:2,SCALE16G:3};e.prototype.read=function(a,c){return this.spi.send([a|192,new Uint8Array(c)],this.cs).slice(1)};e.prototype.write=function(a,c){return this.spi.write(a,c,this.cs)};e.prototype.setPowerMode=function(a){var c=b.XYZ_EN_MASK,f=this.g_scale<<4,d=0;this.data=void 0;switch(a){case "normal":c|=b.ODR_MASK_100HZ;this.g_mgpb=4<<this.g_scale;d=10;break;case "low":c|=b.ODR_MASK_1HZ;this.g_mgpb=4<<this.g_scale;d=1E3;break;case "fast":c|=b.ODR_MASK_1620HZ|b.LPEN_MASK;this.g_mgpb=16<<this.g_scale;
d=1;break;case "highres":c|=b.ODR_MASK_HIGH_RES;f|=b.HR_MASK;this.g_mgpb=1<<this.g_scale;d=1;break;case "powerdown":d=c=0;break;default:throw"Unknown power mode "+JSON.stringify(a);}this.write(b.CTRL_REG1,c);this.write(b.CTRL_REG4,f);this.mode=a;this.interval&&clearInterval(this.interval);this.interval=void 0;d&&(this.interval=setInterval(function(a){a.data=new DataView((new Uint8Array(a.read(b.OUT_X_L,6))).buffer);a.callback&&a.callback(a.getXYZ())},d,this))};e.prototype.getXYZ=function(){if(this.data){var a=
1/(16<<this.g_scale)*1E3/1024;return{x:this.data.getInt16(0,1)*a,y:this.data.getInt16(2,1)*a,z:this.data.getInt16(4,1)*a}}};exports.connectSPI=function(a,c,b){return new e(a,c,b)}